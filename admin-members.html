<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Members</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="admin-dashboard.html">MS Power Fitness Admin</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto">
                <li class="nav-item"><a class="nav-link" href="admin-dashboard.html">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link active" href="admin-members.html">Memberships</a></li>
                <li class="nav-item"><a class="nav-link" href="admin-admins.html">Admins</a></li>
                <li class="nav-item"><a class="nav-link" href="admin-approvals.html">Approvals</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="row mb-3 align-items-center">
        <div class="col-md-5">
            <input type="text" id="searchInput" class="form-control" placeholder="Search by ID, Name, Email or Phone...">
        </div>
        <div class="col-md-7 text-end">
            <button class="btn btn-warning btn-sm me-2" onclick="setFilter('Expiring')">Show Expiring</button>
            <button class="btn btn-danger btn-sm me-2" onclick="setFilter('Expired')">Show Expired</button>
            <button class="btn btn-secondary btn-sm me-2" onclick="setFilter('All')">Reset</button>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMemberModal"><i class="fas fa-plus"></i> Add Member</button>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <h5 class="mb-0">Member List <span id="currentFilterBadge" class="badge bg-secondary ms-2">All</span></h5>
        </div>
        <div class="card-body p-0">
            <table class="table table-hover mb-0 align-middle">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Plan</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="membersTable">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<div class="modal fade" id="addMemberModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New Member (Manual)</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3"><label>Name</label><input type="text" class="form-control"></div>
                    <div class="mb-3"><label>Email</label><input type="email" class="form-control"></div>
                    <div class="mb-3"><label>Plan</label>
                        <select class="form-select"><option>Monthly (₹800)</option><option>Yearly (₹8000)</option></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">Save Member</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Accurate Mock Data (Matches Dashboard Numbers: 3 Active, 1 Expiring, 1 Expired)
    const members = [
        {id: 101, name: "Rahul Sharma", email: "rahul@test.com", plan: "Yearly", status: "Active"},
        {id: 102, name: "Priya Singh", email: "priya@test.com", plan: "Monthly", status: "Active"},
        {id: 103, name: "Amit Kumar", email: "amit@test.com", plan: "Monthly", status: "Expiring"},
        {id: 104, name: "Sneha Reddy", email: "sneha@test.com", plan: "Monthly", status: "Expired"},
        {id: 105, name: "Vikram Das", email: "vikram@test.com", plan: "Yearly", status: "Active"},
    ];

    const tableBody = document.getElementById('membersTable');
    const badgeSpan = document.getElementById('currentFilterBadge');

    function renderTable(data) {
        tableBody.innerHTML = "";
        if(data.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="6" class="text-center py-3 text-muted">No members found</td></tr>`;
            return;
        }

        data.forEach(m => {
            let badgeClass = m.status === 'Active' ? 'success' : (m.status === 'Expiring' ? 'warning' : 'danger');
            let row = `
                <tr>
                    <td>#${m.id}</td>
                    <td>${m.name}</td>
                    <td>${m.email}</td>
                    <td>${m.plan}</td>
                    <td><span class="badge bg-${badgeClass}">${m.status}</span></td>
                    <td>
                        <a href="admin-member-view.html?id=${m.id}" class="btn btn-sm btn-outline-primary"><i class="fas fa-eye"></i> View</a>
                    </td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });
    }

    // Filter Logic
    function setFilter(status) {
        badgeSpan.textContent = status;
        if(status === 'All') {
            renderTable(members);
        } else {
            renderTable(members.filter(m => m.status === status));
        }
    }

    // Check URL Params on Load
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const filterParam = urlParams.get('filter');
        if(filterParam) {
            setFilter(filterParam);
        } else {
            renderTable(members);
        }
    };

    // Search Logic
    document.getElementById('searchInput').addEventListener('keyup', function(e) {
        const term = e.target.value.toLowerCase();
        const filtered = members.filter(m => 
            m.name.toLowerCase().includes(term) || 
            m.email.toLowerCase().includes(term) ||
            m.id.toString().includes(term)
        );
        renderTable(filtered);
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>